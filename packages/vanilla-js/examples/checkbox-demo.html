<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cin7 DSL - Vanilla JS Checkbox Component Demo</title>
  <link rel="stylesheet" href="../../design-tokens/src/components/checkbox.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .demo-section {
      margin-bottom: 3rem;
      padding: 2rem;
      border: 1px solid #e1e3e5;
      border-radius: 8px;
    }
    .demo-section h2 {
      margin-top: 0;
    }
    .demo-controls {
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid #e1e3e5;
    }
    .demo-controls button {
      margin-right: 0.5rem;
      padding: 0.5rem 1rem;
      background: #008060;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .demo-controls button:hover {
      background: #006e52;
    }
    .demo-output {
      margin-top: 1rem;
      padding: 1rem;
      background: #f6f6f7;
      border-radius: 4px;
      font-family: monospace;
      font-size: 0.875rem;
    }
    .checkbox-container {
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <h1>Cin7 DSL - Vanilla JS Checkbox Component Demo</h1>
  
  <div class="demo-section">
    <h2>Basic Checkbox</h2>
    <div id="basic-checkbox" class="checkbox-container"></div>
    <div class="demo-output" id="basic-output">
      State: <span id="basic-state">false</span>
    </div>
  </div>

  <div class="demo-section">
    <h2>Multiple Checkboxes with Different Options</h2>
    <div id="multiple-checkboxes"></div>
    <div class="demo-output" id="multiple-output">
      Selected options: <span id="selected-options">[]</span>
    </div>
  </div>

  <div class="demo-section">
    <h2>Interactive Controls</h2>
    <div id="interactive-checkbox" class="checkbox-container"></div>
    <div class="demo-controls">
      <button onclick="toggleValue()">Toggle Value</button>
      <button onclick="toggleDisabled()">Toggle Disabled</button>
      <button onclick="changeLabel()">Change Label</button>
      <button onclick="getState()">Get State</button>
    </div>
    <div class="demo-output" id="interactive-output">
      Ready for interaction...
    </div>
  </div>

  <div class="demo-section">
    <h2>Event Subscription Demo</h2>
    <div id="event-checkbox" class="checkbox-container"></div>
    <div class="demo-controls">
      <button onclick="subscribeToEvents()">Subscribe to Events</button>
      <button onclick="unsubscribeFromEvents()">Unsubscribe</button>
    </div>
    <div class="demo-output" id="event-output">
      Event log:
      <div id="event-log"></div>
    </div>
  </div>

  <script type="module">
    // Import the CheckboxComponent
    import { CheckboxComponent } from '../src/components/CheckboxComponent.js';

    // Basic Checkbox Demo
    const basicCheckbox = new CheckboxComponent({
      label: 'I agree to the terms and conditions',
      checked: false,
      onChange: (checked) => {
        document.getElementById('basic-state').textContent = checked;
      }
    });
    basicCheckbox.mount('#basic-checkbox');

    // Multiple Checkboxes Demo
    const options = [
      { id: 'email', label: 'Email notifications', default: true },
      { id: 'sms', label: 'SMS notifications', default: false },
      { id: 'push', label: 'Push notifications', default: true }
    ];

    const checkboxes = {};
    const multipleContainer = document.getElementById('multiple-checkboxes');

    options.forEach(option => {
      const container = document.createElement('div');
      container.className = 'checkbox-container';
      multipleContainer.appendChild(container);

      const checkbox = new CheckboxComponent({
        label: option.label,
        checked: option.default,
        onChange: () => updateSelectedOptions()
      });
      
      checkbox.mount(container);
      checkboxes[option.id] = checkbox;
    });

    function updateSelectedOptions() {
      const selected = Object.entries(checkboxes)
        .filter(([id, checkbox]) => checkbox.get())
        .map(([id]) => id);
      document.getElementById('selected-options').textContent = JSON.stringify(selected);
    }

    updateSelectedOptions();

    // Interactive Controls Demo
    const interactiveCheckbox = new CheckboxComponent({
      label: 'Interactive checkbox',
      checked: false
    });
    interactiveCheckbox.mount('#interactive-checkbox');

    window.toggleValue = function() {
      const currentValue = interactiveCheckbox.get();
      interactiveCheckbox.set(!currentValue);
      document.getElementById('interactive-output').textContent = 
        `Value toggled to: ${!currentValue}`;
    };

    window.toggleDisabled = function() {
      const isDisabled = interactiveCheckbox.isDisabled();
      interactiveCheckbox.setDisabled(!isDisabled);
      document.getElementById('interactive-output').textContent = 
        `Disabled state: ${!isDisabled}`;
    };

    window.changeLabel = function() {
      const newLabel = `Updated label (${new Date().toLocaleTimeString()})`;
      interactiveCheckbox.setLabel(newLabel);
      document.getElementById('interactive-output').textContent = 
        `Label changed to: "${newLabel}"`;
    };

    window.getState = function() {
      const state = {
        value: interactiveCheckbox.get(),
        label: interactiveCheckbox.getLabel(),
        disabled: interactiveCheckbox.isDisabled()
      };
      document.getElementById('interactive-output').textContent = 
        `State: ${JSON.stringify(state, null, 2)}`;
    };

    // Event Subscription Demo
    const eventCheckbox = new CheckboxComponent({
      label: 'Subscribe to my events'
    });
    eventCheckbox.mount('#event-checkbox');

    let subscriptions = [];
    const eventLog = document.getElementById('event-log');

    function logEvent(message) {
      const entry = document.createElement('div');
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      eventLog.appendChild(entry);
      
      // Keep only last 5 entries
      if (eventLog.children.length > 5) {
        eventLog.removeChild(eventLog.firstChild);
      }
    }

    window.subscribeToEvents = function() {
      if (subscriptions.length > 0) {
        logEvent('Already subscribed!');
        return;
      }

      subscriptions.push(
        eventCheckbox.onCheck(() => logEvent('✓ Check event fired')),
        eventCheckbox.onUncheck(() => logEvent('✗ Uncheck event fired')),
        eventCheckbox.onChange((value) => logEvent(`Change event: ${value}`))
      );
      
      logEvent('Subscribed to all events');
    };

    window.unsubscribeFromEvents = function() {
      subscriptions.forEach(unsubscribe => unsubscribe());
      subscriptions = [];
      logEvent('Unsubscribed from all events');
    };
  </script>
</body>
</html>