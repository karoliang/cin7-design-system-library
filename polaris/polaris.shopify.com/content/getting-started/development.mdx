---
title: Development Workflow
description: 'Set up your development environment and learn the recommended workflow for building applications with Cin7 DSL.'
showTOC: true
keywords:
  - development
  - workflow
  - setup
  - environment
  - tooling
  - build
  - testing
  - deployment
order: 4
icon: CodeIcon
---

# {frontmatter.title}

<Lede>{frontmatter.description}</Lede>

## Prerequisites

Before starting development with Cin7 DSL, ensure you have the following tools installed:

### Required Tools

- **Node.js** (v18 or higher)
- **pnpm** (v8 or higher) - Package manager
- **Git** - Version control
- **VS Code** - Recommended IDE with extensions

### Recommended VS Code Extensions

```json
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next",
    "bradlc.vscode-tailwindcss",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "ms-vscode.vscode-json",
    "shopify.polaris-for-vscode"
  ]
}
```

## Project Setup

### 1. Initialize New Project

```bash
# Create new Cin7 DSL project
npx @cin7/create-dsl-app my-app
cd my-app

# Install dependencies
pnpm install

# Start development server
pnpm dev
```

### 2. Project Structure

```
my-app/
├── src/
│   ├── components/          # React components
│   │   ├── common/         # Shared components
│   │   ├── forms/          # Form components
│   │   └── grids/          # Data grid components
│   ├── pages/              # Page components
│   ├── services/           # API services
│   ├── stores/             # State management
│   ├── styles/             # Global styles
│   ├── types/              # TypeScript types
│   └── utils/              # Utility functions
├── public/                 # Static assets
├── tests/                  # Test files
├── docs/                   # Project documentation
└── tools/                  # Build and development tools
```

### 3. Configuration Files

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { resolve } from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
      '@components': resolve(__dirname, 'src/components'),
      '@services': resolve(__dirname, 'src/services'),
      '@stores': resolve(__dirname, 'src/stores'),
      '@types': resolve(__dirname, 'src/types'),
      '@utils': resolve(__dirname, 'src/utils'),
    },
  },
  server: {
    port: 3000,
    open: true,
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
  },
});
```

```typescript
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "allowJs": false,
    "skipLibCheck": true,
    "esModuleInterop": false,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"],
      "@services/*": ["src/services/*"],
      "@stores/*": ["src/stores/*"],
      "@types/*": ["src/types/*"],
      "@utils/*": ["src/utils/*"]
    }
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

## Development Workflow

### 1. Component Development

```tsx
// src/components/UserCard/UserCard.tsx
import React from 'react';
import { Card, Avatar, Text, Stack, Badge } from '@shopify/polaris';
import { User } from '@types/user';

interface UserCardProps {
  user: User;
  onEdit?: (user: User) => void;
  onDelete?: (user: User) => void;
}

export const UserCard: React.FC<UserCardProps> = ({ 
  user, 
  onEdit, 
  onDelete 
}) => {
  const handleEdit = () => onEdit?.(user);
  const handleDelete = () => onDelete?.(user);

  return (
    <Card>
      <Stack alignment="center" spacing="tight">
        <Avatar name={user.name} />
        <Stack.Item fill>
          <Text variant="headingMd">{user.name}</Text>
          <Text color="subdued">{user.email}</Text>
        </Stack.Item>
        <Badge status={user.isActive ? 'success' : 'critical'}>
          {user.isActive ? 'Active' : 'Inactive'}
        </Badge>
      </Stack>
    </Card>
  );
};
```

### 2. Service Layer Development

```typescript
// src/services/userService.ts
import { apiClient } from './apiClient';
import { User, CreateUserRequest, UpdateUserRequest } from '@types/user';

export class UserService {
  async getUsers(): Promise<User[]> {
    const response = await apiClient.get<User[]>('/users');
    return response.data;
  }

  async getUser(id: string): Promise<User> {
    const response = await apiClient.get<User>(`/users/${id}`);
    return response.data;
  }

  async createUser(userData: CreateUserRequest): Promise<User> {
    const response = await apiClient.post<User>('/users', userData);
    return response.data;
  }

  async updateUser(id: string, userData: UpdateUserRequest): Promise<User> {
    const response = await apiClient.put<User>(`/users/${id}`, userData);
    return response.data;
  }

  async deleteUser(id: string): Promise<void> {
    await apiClient.delete(`/users/${id}`);
  }
}

export const userService = new UserService();
```

### 3. State Management

```typescript
// src/stores/userStore.ts
import { create } from 'zustand';
import { devtools } from 'zustand/middleware';
import { User } from '@types/user';

interface UserState {
  users: User[];
  selectedUser: User | null;
  isLoading: boolean;
  error: string | null;
  setUsers: (users: User[]) => void;
  setSelectedUser: (user: User | null) => void;
  setLoading: (loading: boolean) => void;
  setError: (error: string | null) => void;
  addUser: (user: User) => void;
  updateUser: (user: User) => void;
  removeUser: (id: string) => void;
}

export const useUserStore = create<UserState>()(
  devtools(
    (set) => ({
      users: [],
      selectedUser: null,
      isLoading: false,
      error: null,
      setUsers: (users) => set({ users }),
      setSelectedUser: (user) => set({ selectedUser: user }),
      setLoading: (loading) => set({ isLoading: loading }),
      setError: (error) => set({ error }),
      addUser: (user) => set((state) => ({ 
        users: [...state.users, user] 
      })),
      updateUser: (user) => set((state) => ({
        users: state.users.map(u => u.id === user.id ? user : u)
      })),
      removeUser: (id) => set((state) => ({
        users: state.users.filter(u => u.id !== id)
      })),
    }),
    { name: 'user-store' }
  )
);
```

### 4. React Query Integration

```typescript
// src/hooks/useUsers.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { userService } from '@services/userService';
import { User, CreateUserRequest, UpdateUserRequest } from '@types/user';

export const useUsers = () => {
  return useQuery({
    queryKey: ['users'],
    queryFn: () => userService.getUsers(),
    staleTime: 5 * 60 * 1000, // 5 minutes
  });
};

export const useUser = (id: string) => {
  return useQuery({
    queryKey: ['user', id],
    queryFn: () => userService.getUser(id),
    enabled: !!id,
  });
};

export const useCreateUser = () => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: (userData: CreateUserRequest) => 
      userService.createUser(userData),
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['users'] });
    },
  });
};

export const useUpdateUser = () => {
  const queryClient = useQueryClient();

  return useMutation({
    mutationFn: ({ id, userData }: { id: string; userData: UpdateUserRequest }) =>
      userService.updateUser(id, userData),
    onSuccess: (updatedUser) => {
      queryClient.setQueryData(['user', updatedUser.id], updatedUser);
      queryClient.invalidateQueries({ queryKey: ['users'] });
    },
  });
};
```

## Build and Development Scripts

### Package.json Scripts

```json
{
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "test": "vitest",
    "test:ui": "vitest --ui",
    "test:coverage": "vitest run --coverage",
    "e2e": "playwright test",
    "e2e:ui": "playwright test --ui",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "lint:fix": "eslint . --ext ts,tsx --fix",
    "format": "prettier --write .",
    "format:check": "prettier --check .",
    "type-check": "tsc --noEmit",
    "storybook": "storybook dev -p 6006",
    "build-storybook": "storybook build"
  }
}
```

### Development Commands

```bash
# Start development server
pnpm dev

# Build for production
pnpm build

# Preview production build
pnpm preview

# Run tests
pnpm test

# Run tests with coverage
pnpm test:coverage

# Run E2E tests
pnpm e2e

# Lint and format code
pnpm lint
pnpm format

# Type checking
pnpm type-check
```

## Testing Strategy

### Unit Tests with Vitest

```typescript
// src/components/UserCard/UserCard.test.tsx
import { render, screen, fireEvent } from '@testing-library/react';
import { UserCard } from './UserCard';
import { User } from '@types/user';

const mockUser: User = {
  id: '1',
  name: 'John Doe',
  email: 'john@example.com',
  isActive: true,
  createdAt: new Date(),
};

describe('UserCard', () => {
  it('renders user information correctly', () => {
    render(<UserCard user={mockUser} />);
    
    expect(screen.getByText('John Doe')).toBeInTheDocument();
    expect(screen.getByText('john@example.com')).toBeInTheDocument();
    expect(screen.getByText('Active')).toBeInTheDocument();
  });

  it('calls onEdit when edit button is clicked', () => {
    const handleEdit = vi.fn();
    render(<UserCard user={mockUser} onEdit={handleEdit} />);
    
    fireEvent.click(screen.getByText('Edit'));
    expect(handleEdit).toHaveBeenCalledWith(mockUser);
  });
});
```

### Integration Tests

```typescript
// src/pages/UserManagement/UserManagement.test.tsx
import { render, screen, waitFor } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { UserManagement } from './UserManagement';
import { userService } from '@services/userService';

vi.mock('@services/userService');

describe('UserManagement', () => {
  let queryClient: QueryClient;

  beforeEach(() => {
    queryClient = new QueryClient({
      defaultOptions: {
        queries: { retry: false },
      },
    });
  });

  it('loads and displays users', async () => {
    const mockUsers = [
      { id: '1', name: 'John Doe', email: 'john@example.com' },
      { id: '2', name: 'Jane Smith', email: 'jane@example.com' },
    ];

    vi.mocked(userService.getUsers).mockResolvedValue(mockUsers);

    render(
      <QueryClientProvider client={queryClient}>
        <UserManagement />
      </QueryClientProvider>
    );

    await waitFor(() => {
      expect(screen.getByText('John Doe')).toBeInTheDocument();
      expect(screen.getByText('Jane Smith')).toBeInTheDocument();
    });
  });
});
```

### End-to-End Tests with Playwright

```typescript
// tests/e2e/user-management.spec.ts
import { test, expect } from '@playwright/test';

test.describe('User Management', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/users');
  });

  test('should create a new user', async ({ page }) => {
    await page.click('[data-testid="create-user-button"]');
    await page.fill('[data-testid="name-input"]', 'John Doe');
    await page.fill('[data-testid="email-input"]', 'john@example.com');
    await page.click('[data-testid="save-button"]');

    await expect(page.locator('[data-testid="user-list"]')).toContainText('John Doe');
  });

  test('should edit an existing user', async ({ page }) => {
    await page.click('[data-testid="edit-user-button"]');
    await page.fill('[data-testid="name-input"]', 'Updated Name');
    await page.click('[data-testid="save-button"]');

    await expect(page.locator('[data-testid="user-list"]')).toContainText('Updated Name');
  });
});
```

## Code Quality

### ESLint Configuration

```javascript
// .eslintrc.js
module.exports = {
  root: true,
  env: { browser: true, es2020: true },
  extends: [
    'eslint:recommended',
    '@typescript-eslint/recommended',
    'plugin:react-hooks/recommended',
    'plugin:react/recommended',
    'plugin:jsx-a11y/recommended',
    '@shopify/eslint-plugin',
  ],
  ignorePatterns: ['dist', '.eslintrc.cjs'],
  parser: '@typescript-eslint/parser',
  plugins: ['react-refresh'],
  rules: {
    'react-refresh/only-export-components': [
      'warn',
      { allowConstantExport: true },
    ],
    'react/react-in-jsx-scope': 'off',
    'react/prop-types': 'off',
    '@typescript-eslint/no-unused-vars': 'error',
    'jsx-a11y/no-autofocus': 'off',
  },
  settings: {
    react: {
      version: 'detect',
    },
  },
};
```

### Prettier Configuration

```javascript
// .prettierrc.js
module.exports = {
  semi: true,
  trailingComma: 'es5',
  singleQuote: true,
  printWidth: 80,
  tabWidth: 2,
  useTabs: false,
  endOfLine: 'lf',
  arrowParens: 'avoid',
  bracketSpacing: true,
  jsxBracketSameLine: false,
  jsxSingleQuote: false,
  quoteProps: 'as-needed',
};
```

## Git Workflow

### Branching Strategy

```bash
# Feature development
git checkout -b feature/user-management
git commit -m "feat: add user management functionality"
git push origin feature/user-management

# Bug fixes
git checkout -b bugfix/user-validation
git commit -m "fix: resolve user validation issues"
git push origin bugfix/user-validation

# Hotfixes
git checkout -b hotfix/critical-bug
git commit -m "hotfix: resolve critical authentication bug"
git push origin hotfix/critical-bug
```

### Commit Convention

```bash
# Format: type(scope): description
feat(users): add user creation functionality
fix(auth): resolve login validation issue
docs(readme): update installation instructions
style(header): improve responsive design
refactor(api): optimize user service performance
test(users): add comprehensive unit tests
chore(deps): update dependencies
```

### Pre-commit Hooks

```json
// .husky/pre-commit
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

pnpm lint-staged
```

```json
// package.json
{
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write"
    ],
    "*.{json,md}": [
      "prettier --write"
    ]
  }
}
```

## Deployment

### Production Build

```bash
# Build for production
pnpm build

# Preview production build locally
pnpm preview

# Analyze bundle size
pnpm build --analyze
```

### Environment Configuration

```typescript
// src/config/environment.ts
export const config = {
  apiUrl: import.meta.env.VITE_API_URL || 'http://localhost:3001',
  environment: import.meta.env.MODE,
  isDevelopment: import.meta.env.DEV,
  isProduction: import.meta.env.PROD,
  version: import.meta.env.PACKAGE_VERSION,
};
```

### CI/CD Pipeline

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: pnpm/action-setup@v2
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'pnpm'
      
      - run: pnpm install --frozen-lockfile
      - run: pnpm type-check
      - run: pnpm lint
      - run: pnpm test:coverage
      - run: pnpm e2e
      - run: pnpm build

  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3
      - run: pnpm build
      - uses: actions/deploy-pages@v2
        with:
          artifact: dist
```

## Performance Optimization

### Code Splitting

```typescript
// Lazy load components
const UserManagement = lazy(() => import('./pages/UserManagement'));
const Reports = lazy(() => import('./pages/Reports'));

// Route-based code splitting
const AppRoutes = () => (
  <Routes>
    <Route path="/users" element={
      <Suspense fallback={<Spinner />}>
        <UserManagement />
      </Suspense>
    } />
    <Route path="/reports" element={
      <Suspense fallback={<Spinner />}>
        <Reports />
      </Suspense>
    } />
  </Routes>
);
```

### Bundle Analysis

```bash
# Analyze bundle size
pnpm build --analyze

# Generate bundle report
pnpm build --report
```

## Vanilla JavaScript

For lightweight UI interactions and general functionality, Cin7 DSL provides utilities and patterns for incorporating vanilla JavaScript alongside React and Polaris components.

### When to Use Vanilla JavaScript

- **Performance-critical animations**: Direct DOM manipulation for smooth animations
- **Legacy system integration**: Bridging with existing non-React codebases
- **Simple interactions**: Basic event handling and DOM updates
- **Third-party library integration**: Wrapping vanilla JS libraries

### Setup and Configuration

```typescript
// src/utils/domUtils.ts
export class DOMUtils {
  static addClass(element: HTMLElement, className: string): void {
    element.classList.add(className);
  }

  static removeClass(element: HTMLElement, className: string): void {
    element.classList.remove(className);
  }

  static toggleClass(element: HTMLElement, className: string): void {
    element.classList.toggle(className);
  }

  static animate(element: HTMLElement, keyframes: Keyframe[], options: KeyframeAnimationOptions): Animation {
    return element.animate(keyframes, options);
  }

  static debounce<T extends (...args: any[]) => any>(
    func: T,
    wait: number
  ): (...args: Parameters<T>) => void {
    let timeout: NodeJS.Timeout;
    return (...args: Parameters<T>) => {
      clearTimeout(timeout);
      timeout = setTimeout(() => func(...args), wait);
    };
  }
}
```

### Integration with React Components

```tsx
// src/components/AnimatedCard/AnimatedCard.tsx
import React, { useRef, useEffect } from 'react';
import { Card } from '@shopify/polaris';
import { DOMUtils } from '@utils/domUtils';

interface AnimatedCardProps {
  children: React.ReactNode;
  animateOnMount?: boolean;
}

export const AnimatedCard: React.FC<AnimatedCardProps> = ({ 
  children, 
  animateOnMount = true 
}) => {
  const cardRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    if (animateOnMount && cardRef.current) {
      const animation = DOMUtils.animate(cardRef.current, [
        { opacity: 0, transform: 'translateY(20px)' },
        { opacity: 1, transform: 'translateY(0)' }
      ], {
        duration: 300,
        easing: 'ease-out'
      });

      return () => animation.cancel();
    }
  }, [animateOnMount]);

  const handleMouseEnter = () => {
    if (cardRef.current) {
      DOMUtils.addClass(cardRef.current, 'card-hover');
    }
  };

  const handleMouseLeave = () => {
    if (cardRef.current) {
      DOMUtils.removeClass(cardRef.current, 'card-hover');
    }
  };

  return (
    <div 
      ref={cardRef}
      onMouseEnter={handleMouseEnter}
      onMouseLeave={handleMouseLeave}
    >
      <Card>{children}</Card>
    </div>
  );
};
```

### Event Handling Utilities

```typescript
// src/utils/eventUtils.ts
export class EventUtils {
  static on<K extends keyof HTMLElementEventMap>(
    element: HTMLElement,
    event: K,
    handler: (event: HTMLElementEventMap[K]) => void,
    options?: boolean | AddEventListenerOptions
  ): () => void {
    element.addEventListener(event, handler, options);
    return () => element.removeEventListener(event, handler, options);
  }

  static once<K extends keyof HTMLElementEventMap>(
    element: HTMLElement,
    event: K,
    handler: (event: HTMLElementEventMap[K]) => void
  ): void {
    const onceHandler = (e: HTMLElementEventMap[K]) => {
      handler(e);
      element.removeEventListener(event, onceHandler);
    };
    element.addEventListener(event, onceHandler);
  }

  static delegate<K extends keyof HTMLElementEventMap>(
    container: HTMLElement,
    selector: string,
    event: K,
    handler: (event: HTMLElementEventMap[K], target: HTMLElement) => void
  ): () => void {
    const delegateHandler = (e: HTMLElementEventMap[K]) => {
      const target = (e.target as HTMLElement).closest(selector);
      if (target && container.contains(target)) {
        handler(e, target as HTMLElement);
      }
    };

    container.addEventListener(event, delegateHandler);
    return () => container.removeEventListener(event, delegateHandler);
  }
}
```

### Custom Hooks for Vanilla JS Integration

```typescript
// src/hooks/useVanillaJS.ts
import { useEffect, useRef } from 'react';
import { EventUtils } from '@utils/eventUtils';

export const useVanillaJS = (
  initFn: (element: HTMLElement) => void | (() => void),
  deps: React.DependencyList = []
) => {
  const ref = useRef<HTMLElement>(null);
  const cleanupRef = useRef<(() => void) | null>(null);

  useEffect(() => {
    if (ref.current) {
      cleanupRef.current = initFn(ref.current) || null;
    }

    return () => {
      if (cleanupRef.current) {
        cleanupRef.current();
      }
    };
  }, deps);

  return ref;
};

export const useEventListener = <K extends keyof HTMLElementEventMap>(
  eventName: K,
  handler: (event: HTMLElementEventMap[K]) => void,
  element?: HTMLElement | null,
  options?: boolean | AddEventListenerOptions
) => {
  const savedHandler = useRef(handler);

  useEffect(() => {
    savedHandler.current = handler;
  }, [handler]);

  useEffect(() => {
    const targetElement = element || document;
    if (!targetElement?.addEventListener) return;

    const eventListener = (event: HTMLElementEventMap[K]) => {
      savedHandler.current(event);
    };

    targetElement.addEventListener(eventName, eventListener, options);

    return () => {
      targetElement.removeEventListener(eventName, eventListener, options);
    };
  }, [eventName, element, options]);
};
```

## TypeScript

TypeScript provides type safety and enhanced developer experience for business logic in Cin7 DSL applications.

### Project Configuration

```typescript
// tsconfig.json (Extended configuration)
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "allowJs": false,
    "skipLibCheck": true,
    "esModuleInterop": false,
    "allowSyntheticDefaultImports": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "module": "ESNext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "removeComments": false,
    "importHelpers": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"],
      "@services/*": ["src/services/*"],
      "@stores/*": ["src/stores/*"],
      "@types/*": ["src/types/*"],
      "@utils/*": ["src/utils/*"]
    }
  },
  "include": ["src", "types"],
  "exclude": ["node_modules", "dist", "build"]
}
```

### Type Definitions

```typescript
// src/types/common.ts
export interface BaseEntity {
  id: string;
  createdAt: Date;
  updatedAt: Date;
  createdBy: string;
  updatedBy: string;
}

export interface PaginatedResponse<T> {
  data: T[];
  pagination: {
    page: number;
    pageSize: number;
    total: number;
    totalPages: number;
  };
}

export interface ApiResponse<T> {
  success: boolean;
  data: T;
  message?: string;
  errors?: Record<string, string[]>;
}

export interface FilterCriteria {
  field: string;
  operator: 'eq' | 'ne' | 'gt' | 'gte' | 'lt' | 'lte' | 'like' | 'in' | 'nin';
  value: any;
}

export interface SortCriteria {
  field: string;
  direction: 'asc' | 'desc';
}

export interface QueryParams {
  page?: number;
  pageSize?: number;
  filters?: FilterCriteria[];
  sort?: SortCriteria[];
  search?: string;
}
```

### Domain Types

```typescript
// src/types/user.ts
import { BaseEntity } from './common';

export interface User extends BaseEntity {
  name: string;
  email: string;
  avatar?: string;
  isActive: boolean;
  roles: UserRole[];
  profile: UserProfile;
  preferences: UserPreferences;
}

export interface UserRole {
  id: string;
  name: string;
  permissions: Permission[];
}

export interface Permission {
  id: string;
  name: string;
  resource: string;
  action: string;
}

export interface UserProfile {
  firstName: string;
  lastName: string;
  phoneNumber?: string;
  address?: Address;
  dateOfBirth?: Date;
  timezone: string;
  locale: string;
}

export interface Address {
  street: string;
  city: string;
  state: string;
  zipCode: string;
  country: string;
}

export interface UserPreferences {
  theme: 'light' | 'dark' | 'system';
  notifications: NotificationPreferences;
  language: string;
}

export interface NotificationPreferences {
  email: boolean;
  push: boolean;
  sms: boolean;
  categories: {
    security: boolean;
    updates: boolean;
    marketing: boolean;
  };
}

// Request/Response types
export interface CreateUserRequest {
  name: string;
  email: string;
  password: string;
  profile: Omit<UserProfile, 'dateOfBirth'> & { dateOfBirth?: string };
  roles: string[];
}

export interface UpdateUserRequest {
  name?: string;
  email?: string;
  isActive?: boolean;
  profile?: Partial<UserProfile>;
  roles?: string[];
}

export interface UserListResponse extends PaginatedResponse<User> {}

export interface UserResponse extends ApiResponse<User> {}
```

### Advanced Type Patterns

```typescript
// src/types/utilities.ts

// Utility types for API responses
export type AsyncState<T> = {
  data: T | null;
  loading: boolean;
  error: string | null;
};

// Form state types
export type FormState<T> = {
  values: T;
  errors: Partial<Record<keyof T, string>>;
  touched: Partial<Record<keyof T, boolean>>;
  isValid: boolean;
  isSubmitting: boolean;
};

// Event handler types
export type EventHandler<T = HTMLElement> = (event: React.SyntheticEvent<T>) => void;
export type ChangeHandler<T = HTMLInputElement> = (event: React.ChangeEvent<T>) => void;
export type SubmitHandler<T = HTMLFormElement> = (event: React.FormEvent<T>) => void;

// Component prop types
export type ComponentProps<T extends React.ElementType> = React.ComponentPropsWithoutRef<T>;
export type PolymorphicProps<T extends React.ElementType> = ComponentProps<T> & {
  as?: T;
};

// Validation types
export type ValidationRule<T> = {
  required?: boolean;
  min?: number;
  max?: number;
  pattern?: RegExp;
  custom?: (value: T) => string | null;
};

export type ValidationSchema<T> = {
  [K in keyof T]?: ValidationRule<T[K]>;
};

// Generic CRUD operations
export type CRUDOperations<T, CreateDTO = Omit<T, keyof BaseEntity>, UpdateDTO = Partial<CreateDTO>> = {
  create: (data: CreateDTO) => Promise<T>;
  read: (id: string) => Promise<T>;
  update: (id: string, data: UpdateDTO) => Promise<T>;
  delete: (id: string) => Promise<void>;
  list: (params?: QueryParams) => Promise<PaginatedResponse<T>>;
};
```

### Type-Safe API Client

```typescript
// src/services/apiClient.ts
import { ApiResponse, PaginatedResponse, QueryParams } from '@types/common';

export class TypedApiClient {
  private baseUrl: string;
  private defaultHeaders: Record<string, string>;

  constructor(baseUrl: string, defaultHeaders: Record<string, string> = {}) {
    this.baseUrl = baseUrl;
    this.defaultHeaders = {
      'Content-Type': 'application/json',
      ...defaultHeaders,
    };
  }

  private async request<T>(
    endpoint: string,
    options: RequestInit = {}
  ): Promise<ApiResponse<T>> {
    const url = `${this.baseUrl}${endpoint}`;
    const config: RequestInit = {
      ...options,
      headers: {
        ...this.defaultHeaders,
        ...options.headers,
      },
    };

    try {
      const response = await fetch(url, config);
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();
      return data as ApiResponse<T>;
    } catch (error) {
      throw new Error(`API request failed: ${error}`);
    }
  }

  async get<T>(endpoint: string, params?: QueryParams): Promise<ApiResponse<T>> {
    const searchParams = new URLSearchParams();
    
    if (params) {
      Object.entries(params).forEach(([key, value]) => {
        if (value !== undefined) {
          searchParams.append(key, String(value));
        }
      });
    }

    const url = searchParams.toString() ? `${endpoint}?${searchParams}` : endpoint;
    return this.request<T>(url);
  }

  async post<T, U = any>(endpoint: string, data: U): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, {
      method: 'POST',
      body: JSON.stringify(data),
    });
  }

  async put<T, U = any>(endpoint: string, data: U): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
  }

  async delete<T>(endpoint: string): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, {
      method: 'DELETE',
    });
  }

  async getPaginated<T>(endpoint: string, params?: QueryParams): Promise<PaginatedResponse<T>> {
    const response = await this.get<PaginatedResponse<T>>(endpoint, params);
    return response.data;
  }
}

// Usage example
const apiClient = new TypedApiClient('/api/v1');

// Type-safe service methods
export const userApiClient = {
  getUsers: (params?: QueryParams) => 
    apiClient.getPaginated<User>('/users', params),
  
  getUser: (id: string) => 
    apiClient.get<User>(`/users/${id}`),
  
  createUser: (data: CreateUserRequest) => 
    apiClient.post<User, CreateUserRequest>('/users', data),
  
  updateUser: (id: string, data: UpdateUserRequest) => 
    apiClient.put<User, UpdateUserRequest>(`/users/${id}`, data),
  
  deleteUser: (id: string) => 
    apiClient.delete<void>(`/users/${id}`),
};
```

### Type-Safe Form Handling

```typescript
// src/hooks/useTypedForm.ts
import { useState, useCallback } from 'react';
import { ValidationSchema, FormState } from '@types/utilities';

export function useTypedForm<T extends Record<string, any>>(
  initialValues: T,
  validationSchema?: ValidationSchema<T>
) {
  const [formState, setFormState] = useState<FormState<T>>({
    values: initialValues,
    errors: {},
    touched: {},
    isValid: true,
    isSubmitting: false,
  });

  const validateField = useCallback((name: keyof T, value: any): string | null => {
    const rules = validationSchema?.[name];
    if (!rules) return null;

    if (rules.required && (!value || value === '')) {
      return 'This field is required';
    }

    if (rules.min && value.length < rules.min) {
      return `Minimum length is ${rules.min}`;
    }

    if (rules.max && value.length > rules.max) {
      return `Maximum length is ${rules.max}`;
    }

    if (rules.pattern && !rules.pattern.test(value)) {
      return 'Invalid format';
    }

    if (rules.custom) {
      return rules.custom(value);
    }

    return null;
  }, [validationSchema]);

  const setFieldValue = useCallback((name: keyof T, value: any) => {
    setFormState(prev => {
      const error = validateField(name, value);
      const newErrors = { ...prev.errors };
      
      if (error) {
        newErrors[name] = error;
      } else {
        delete newErrors[name];
      }

      return {
        ...prev,
        values: { ...prev.values, [name]: value },
        errors: newErrors,
        isValid: Object.keys(newErrors).length === 0,
      };
    });
  }, [validateField]);

  const setFieldTouched = useCallback((name: keyof T, touched = true) => {
    setFormState(prev => ({
      ...prev,
      touched: { ...prev.touched, [name]: touched },
    }));
  }, []);

  const handleSubmit = useCallback(async (
    onSubmit: (values: T) => Promise<void> | void
  ) => {
    setFormState(prev => ({ ...prev, isSubmitting: true }));

    try {
      await onSubmit(formState.values);
    } finally {
      setFormState(prev => ({ ...prev, isSubmitting: false }));
    }
  }, [formState.values]);

  return {
    values: formState.values,
    errors: formState.errors,
    touched: formState.touched,
    isValid: formState.isValid,
    isSubmitting: formState.isSubmitting,
    setFieldValue,
    setFieldTouched,
    handleSubmit,
  };
}
```

### Testing with TypeScript

```typescript
// src/types/testing.ts
import { render, RenderOptions } from '@testing-library/react';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ReactElement } from 'react';

// Custom render function with providers
export interface CustomRenderOptions extends Omit<RenderOptions, 'wrapper'> {
  queryClient?: QueryClient;
}

export function renderWithProviders(
  ui: ReactElement,
  options: CustomRenderOptions = {}
) {
  const { queryClient = new QueryClient({
    defaultOptions: {
      queries: { retry: false },
    },
  }), ...renderOptions } = options;

  function Wrapper({ children }: { children: React.ReactNode }) {
    return (
      <QueryClientProvider client={queryClient}>
        {children}
      </QueryClientProvider>
    );
  }

  return render(ui, { wrapper: Wrapper, ...renderOptions });
}

// Mock type utilities
export type MockedFunction<T extends (...args: any[]) => any> = jest.MockedFunction<T>;

export type MockedClass<T> = {
  [K in keyof T]: T[K] extends (...args: any[]) => any
    ? MockedFunction<T[K]>
    : T[K];
};

// Test data factories
export interface TestDataFactory<T> {
  build: (overrides?: Partial<T>) => T;
  buildList: (count: number, overrides?: Partial<T>) => T[];
}

export function createTestFactory<T>(defaults: T): TestDataFactory<T> {
  return {
    build: (overrides = {}) => ({ ...defaults, ...overrides }),
    buildList: (count, overrides = {}) => 
      Array.from({ length: count }, (_, i) => ({ 
        ...defaults, 
        ...overrides, 
        id: `${defaults.id || 'test'}-${i}` 
      })),
  };
}
```

## Troubleshooting

### Common Issues

1. **Build failures**: Check TypeScript errors and dependency versions
2. **Hot reload issues**: Clear cache and restart development server
3. **Import errors**: Verify path aliases and module resolution
4. **Test failures**: Check test environment configuration

### Debug Configuration

```json
// .vscode/launch.json
{
  "version": "0.2.0",
  "configurations": [
    {
      "name": "Launch Chrome",
      "request": "launch",
      "type": "chrome",
      "url": "http://localhost:3000",
      "webRoot": "${workspaceFolder}/src"
    }
  ]
}
```